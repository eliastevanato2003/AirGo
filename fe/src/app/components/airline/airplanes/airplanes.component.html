<div class="air-go-container">
  <app-navbar></app-navbar>

  <!-- Hero con immagine e filtro dentro -->
  <div class="hero hero-airplanes">
    <h1>Gestione Aerei</h1>
    <p>Qui puoi aggiungere o eliminare aerei della tua compagnia</p>
    <button class="add-btn" (click)="showModal=true">Nuovo aereo</button>

    <!-- Filtro aerei dentro la hero -->
    <div class="search-box filter-inside" [formGroup]="filterForm">
      <div class="input-group">
        <label>ID Aereo</label>
        <input type="number" formControlName="id">
      </div>

      <div class="input-group">
        <label>Modello</label>
        <ng-select
          formControlName="model"
          [items]="models"
          bindLabel="Nome"
          bindValue="IdModello"
          [searchable]="true">
        </ng-select>
      </div>


      <div class="input-group">
        <label>Anno di costruzione</label>
        <input type="number" formControlName="constructionYear">
      </div>

      <div class="input-group">
        <label>Stato</label>
        <select formControlName="inservice">
          <option [value]="true">In servizio</option>
          <option [value]="false">Fuori servizio</option>
        </select>
      </div>

      <button class="search-btn" type="submit" (click)="filtra()">&#10141;</button>
      <button class="search-btn reset" type="button" (click)="reset()">Reset</button>
    </div>
  </div>

  <!-- Lista aerei -->
  <div class="second-container">
    <div class="airplane-list">
      @for(airplane of airplanes; track airplane.IdAereo) {
        <div class="airplane-bar">
          <div class="airplane-info">
            <p><strong>Aereo:</strong> {{ airplane.NomeModello }} - {{ airplane.IdAereo }}</p>
            <p><strong>Anno di costruzione:</strong> {{ airplane.AnnoCostruzione }}</p>

            @if(airplane.InServizio){
              <p><strong>Stato:</strong> <span class="status inservice">In servizio</span></p>
            }@else{
              <p><strong>Stato:</strong> <span class="status outservice">Fuori servizio</span></p>
            }
          </div>

          @if(airplane.InServizio){
            <button class="delete-btn" (click)="ritira(airplane.IdAereo)">Ritira</button>
          }@else{
            <button class="save-btn" (click)="attiva(airplane.IdAereo)">Attiva</button>
            <button class="delete-btn" (click)="deletePlane(airplane.IdAereo)">Elimina</button>
          }
        </div>
      }
    </div>
  </div>

  <!-- Modal aggiunta aereo -->
  @if(showModal) {
    <div class="modal-overlay">
      <div class="modal-content">
        <h3>Nuovo aereo</h3>
        <form [formGroup]="newPlaneForm" (ngSubmit)="addPlane()">
          <label>Modello</label>
          <div class="containerb">
            <div class="input-group">
              <label>Modello</label>
              <ng-select
                formControlName="model"
                [items]="models"
                bindLabel="Nome"
                bindValue="IdModello"
                [searchable]="true">
              </ng-select>
            </div>
            <button type="button" class="add-btn" (click)="toCreate()">Crea</button>
          </div>

          <label>Anno di costruzione</label>
          <input type="number" formControlName="constructionyear">

          <div class="modal-buttons">
            <button type="submit" class="add-btn" [disabled]="newPlaneForm.invalid">Aggiungi</button>
            <button type="button" class="cancel-btn" (click)="closeModal()">Annulla</button>
          </div>
        </form>
      </div>
    </div>
  }

  <app-footer></app-footer>
</div>
